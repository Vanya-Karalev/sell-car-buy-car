{% extends 'base.html' %}
{% load static %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'createad.css' %}"/>
    <script src="{% static 'createad.js' %}"></script>
{% endblock styles %}

{% block content %}
    <form method="post" action="{% url 'createauction' %}" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="container-name">
            <h1>Создать аукцион</h1>
        </div>
        <div class="column">
            <h2>Общая информация:</h2>
            <div class="field">
                <p>Марка:</p>
                <div class="dropdown_brand" onclick="toggleDropdown()" id="dropdownContainer">
                    <input type="text" name="selected_brand_name" placeholder="Марка" class="dropbtn"
                           id="selectedBrandBtn"
                           oninput="filterFunction(this.value)"
                           value="{{ brand_name }}" required>
                    <div class="dropdown-content">
                        {% for brand in brands %}
                            <a class="car-brand" data-brand-id="{{ brand.id }}" data-brand="{{ brand.name }}"
                               onclick="selectBrand(this)">{{ brand.name }}</a>
                        {% endfor %}
                    </div>
                    {% if error_brand_name %}
                        <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_brand_name }}</span>
                    {% endif %}
                </div>
            </div>

            <div class="field">
                <p>Модель:</p>
                <div class="dropdown_model" onclick="toggleModelDropdown()" id="dropdownModelContainer">
                    <input type="text" name="selected_model_name" placeholder="Модель" class="dropbtn"
                           id="selectedModelBtn" disabled
                           oninput="filterModelFunction(this.value)"
                           value="{{ model_name }}" required>
                    <div class=" dropdown-content" id="modelDropdown" data-brand-id="">
                        {% for model in models %}
                            <a class="car-model" data-brand-id="{{ model.brand.id }}" data-model="{{ model.name }}"
                               onclick="selectModel(this)">{{ model.name }}</a>
                        {% endfor %}
                    </div>
                    {% if error_model_name %}
                        <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_model_name }}</span>
                    {% endif %}
                </div>
            </div>


            <div class="field">
                <p>Пробег (в км.):</p>
                <input type="number" name="mileage" placeholder="Пробег" id="mileage" value="{{ mileage }}" required>
                {% if error_mileage %}
                    <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_mileage }}</span>
                {% endif %}
            </div>

            <div class="field">
                <p>Цвет:</p>
                <select name="color" id="color">
                    <option>Белый</option>
                    <option>Черный</option>
                    <option>Голубой</option>
                    <option>Желтый</option>
                </select>
            </div>

            <div class="field">
                <p>Тип кузова:</p>
                <select name="bodytype" id="bodytype">
                    <option>Хэтчбэк (3 дв.)</option>
                    <option>Хэтчбэк (5 дв.)</option>
                    <option>Седан</option>
                    <option>Купе</option>
                    <option>Универсал</option>
                    <option>Внедорожник</option>
                    <option>Пикап</option>
                    <option>Кроссовер</option>
                    <option>Кабриолет</option>
                    <option>Минивен</option>
                    <option>Родстер</option>
                    <option>Лимузин</option>
                </select>
            </div>

            <div class="field">
                <p>VIN номер:</p>
                <input type="text" name="vin" placeholder="VIN" id="vin" value="{{ vin }}" required>
                {% if error_vin %}
                    <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_vin }}</span>
                {% endif %}
            </div>
        </div>
        <h2>Двигатель:</h2>
        <div class="field">

            <p>Тип двигателя:</p>
            <select name="enginetype" id="enginetype">
                <option>Бензин</option>
                <option>Дизель</option>
                <option>Электрический</option>
                <option>Гибрид</option>
            </select>
        </div>

        <div class="field">
            <p>Лошадиные силы:</p>
            <input type="number" name="horsepower" placeholder="Лошадиные силы" id="horsepower"
                   value="{{ horsepower }}" required>
            {% if error_horsepower %}
                <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_horsepower }}</span>
            {% endif %}
        </div>

        <div class="field">
            <p>Объем двигателя:</p>
            <input type="text" name="capacity" placeholder="Объем двигателя" id="capacity" value="{{ capacity }}" required>
            {% if error_capacity %}
                <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_capacity }}</span>
            {% endif %}
        </div>

        <div class="field">
            <p>Крутящий момент:</p>
            <input type="number" name="torque" placeholder="Крутящий момент" id="torque" value="{{ torque }}" required>
            {% if error_torque %}
                <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_torque }}</span>
            {% endif %}
        </div>

        <div class="field">
            <p>Расход топлива:</p>
            <input type="text" name="fuelconsuption" placeholder="Расход" id="fuelconsuption" value="{{ fuelconsuption }}" required>
            {% if error_fuelconsuption %}
                <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_fuelconsuption }}</span>
            {% endif %}
        </div>

        <div class="field">
            <p>Год выпуска:</p>
            <input type="number" name="year" placeholder="Год" id="mileage" value="{{ year }}" required>
            {% if error_year %}
                <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_year }}</span>
            {% endif %}
        </div>
        <h2>Подвеска:</h2>
        <div class="field">

            <p>Тип подвески:</p>
            <select name="suspensiontype" id="suspensiontype">
                <option>Рессорная подвеска</option>
                <option>Торсионная подвеска</option>
                <option>Подвеска с продольными рычагами</option>
                <option>Зависимая подвеска</option>
                <option>Независимая подвеска</option>
                <option>Двухрычажная подвеска</option>
                <option>Подвеска типа Макферсон</option>
                <option>Пневматическая подвеска</option>
                <option>Многорычажная подвеска</option>
            </select>
        </div>

        <div class="field">
            <p>Клиренс (в см.):</p>
            <input type="text" name="clearance" placeholder="Клиренс" id="clearance" value="{{ clearance }}" required>
            {% if error_clearance %}
                <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_clearance }}</span>
            {% endif %}
        </div>
        <h2>Коробка передач:</h2>
        <div class="field">

            <p>Тип коробки передач:</p>
            <select name="gearboxtype" id="gearboxtype">
                <option>Автоматическая</option>
                <option>Механическая</option>
                <option>Вариатор</option>
                <option>Роботизированная</option>
            </select>
        </div>

        <div class="field">
            <p>Число передач:</p>
            <input type="number" name="gearnumber" placeholder="Число передач" id="gearnumber" value="{{ gearnumber }}" required>
            {% if error_gearnumber %}
                <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_gearnumber }}</span>
            {% endif %}
        </div>

        <div class="field">
            <p>Начальная цена:</p>
            <input type="number" name="start_price" placeholder="Начальная цена" id="start_price" value="{{ start_price }}" required>
            {% if error_start_price %}
                <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_start_price }}</span>
            {% endif %}
        </div>

        <div class="field">
            <p>Дата начала аукциона:</p>
            <input type="datetime-local" name="start_date" placeholder="Дата начала аукциона" id="start_date" min="{{ min_date|date:'Y-m-d\TH:i' }}" value="{{ start_date|date:'Y-m-d\TH:i' }}" required>
            {% if error_start_date %}
                <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_start_date }}</span>
            {% endif %}
        </div>
        <div class="field">
            <p>Дата конца аукциона:</p>
            <input type="datetime-local" name="end_date" placeholder="Дата конца аукциона" id="end_date" value="{{ end_date|date:'Y-m-d\TH:i' }}" required>
            {% if error_end_date %}
                <span style="color: #c00000; margin-left: 20px">Ошибка: {{ error_end_date }}</span>
            {% endif %}
        </div>

        <div class="field" style="align-items: start">
            <p>Описание:</p>
            <textarea name="description" placeholder="Описание" id="description" maxlength="1000">{{ description }}</textarea>
        </div>

        <div class="field">
            <p id="photos_count">Выберите фотографии:</p>
            <button class="upload_button" id="upload-avatar-btn" type="button">
                Выбрать
                <input type="file" id="upload-avatar-inp" name="images" accept="image/png, image/jpeg" multiple/>
            </button>
        </div>

        <script>
            document.getElementById('upload-avatar-btn').addEventListener("click", function () {
                document.getElementById('upload-avatar-inp').click();
            });
            document.getElementById('upload-avatar-inp').addEventListener("change", function () {
                var count = document.getElementById('upload-avatar-inp').files.length

                if (count === 1) {
                    document.getElementById('photos_count').innerText =
                        '1 фотография выбрана';
                } else if (count > 1 && count <= 4) {
                    document.getElementById('photos_count').innerText =
                        count + ' фотографии выбрано';
                } else if (count > 20 && count % 10 && count % 10 <= 4) {
                    document.getElementById('photos_count').innerText =
                        count + ' фотографии выбрано';
                } else {
                    document.getElementById('photos_count').innerText =
                        count + ' фотографий выбрано';
                }
            });
        </script>

        <div class="field" style="padding-top: 50px">
            <button type="submit" style="height: 50px; width: 200px">
                Создать аукцион
            </button>
        </div>

    </form>
{% endblock content %}
